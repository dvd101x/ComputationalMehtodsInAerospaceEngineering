# 1.2 Discretizing ODEs
## 1.2.1 First-order ODEs

Many interesting physical phenomena can be modeled by a first-order ODE of the form

$$ u_t = f(u(t)), u(1)=u_0, 0 < t < T, \tag{1.1}$$

where $u(t)$ is the time-dependent state of the system, $u_ t=du/dt$ is the time-derivative of the state, $f(u(t))$ is the forcing function depending on the state, $u_0$ is the initial condition, and $0 < t < T$ indicates that we want to solve the problem forward in time until time $t=T$. We will begin by considering scalar problems where $u(t)\in \mathbb {R}$ (a real number), but in [1.6 Systems of ODE's and Eigenvalue Stability]() we will extend to the vector-valued case where $\mathbf{u}(t)\in \mathbb {R}$ is a $d$-dimensional state vector.

Example
-------

Consider transient heat transfer associated to convective heating or cooling (see [16\. Unified notes on Thermodynamics and Propulsion, Section 18.3](http://web.mit.edu/16.unified/www/SPRING/propulsion/notes/node129.html)). The first law states that the heat into the object is given by the product $\rho V c T_ t$ where $\rho$ is the density, $V$ is the volume, and $c$ is the specific heat. Let $h$ be the heat transfer coefficient and $A$ be the surface area of the body, then the time evolution of temperature is given by

$$A h (T-T_\infty ) = - \rho V c T_ t \tag{1.2}$$

Let $u(t)$ be the non-dimensional temperature difference $(T-T_\infty )/(T_ i-T_\infty )$ where $T(t)$ is the time-dependent temperature in the body (assumed constant throughout, i.e., small Biot number), $T_\infty$ is the surrounding ambient temperature, and $T_i$ is the initial temperature of the body at time $t=0$. Then the governing equation is

$$u_t = -\lambda u \tag{1.3}$$

where $\lambda = \frac{h A}{\rho V c}$. The initial condition is $u(0)=1$.

Write down the analytical solution to the initial value problem and plot it in MATLAB® for values $h=3$, $A=4$, $\rho =10$, $V=9$, and $c=1$. What is the value of $u(2)$? Please answer with at least 3 significant digits.  

<details>
<summary> Solution:</summary>
0.76592833
</details>

## 1.2.2 An example of first order ODE

Ordinary differential equations (ODEs) occur throughout science and engineering.

### Free Fall Example

A model for the velocity $u(t)$ of a spherical object falling freely through the 
atmosphere can be derived by applying Newton's Law. Specifically,

$$ m_ p u_ t = m_ p g - D(u) \tag{1.4} $$

where $m_p$ is the mass of the particle, $g$ is the gravity, $D$ is the aerodynamic 
drag acting on the particle, and $u_t$ denotes the derivative of $u(t)$ with respect 
to time $t$. For low speeds, this drag can be modeled as (recall Unified fluids),

$$\begin{align}
D&=\frac{1}{2}\rho _ g \pi a^2 u^2 C_ D(Re) \tag{1.5}\\
Re &= \frac{2 \rho _ g u a}{\mu _ g} \tag{1.6}\\
C_ D &= \frac{24}{Re} + \frac{6}{1 + \sqrt  {Re}} + 0.4 \tag{1.7}
\end{align}$$

where $\rho _ g$ and $\mu _ g$ are the density and dynamic viscosity of the atmosphere, 
$a$ is the sphere radius, $Re$ is the Reynolds number for the sphere, and $C_ D$ is 
the drag coefficient. To complete the problem specification, an initial condition is 
required on the velocity. For example, at time $t=0$, let $u(0) = u_0$. By solving **Equation 1.4** 
with this initial condition, the velocity at any time $u(t)$ can be found.

### General ODEs

A general ODE is typically written in the form,

$$u_t(t) = f(u(t),t) \tag{1.8}$$

where $f(u(t),t)$ is the forcing function that results in the evolution of $u(t)$ in time. When $f(u(t),t)$ depends on $u(t)$ in a nonlinear manner, then the ODE is called a nonlinear ODE. Note that in these notes, where clarity permits, we will omit the arguments of functions.

For the example defined by Equation 1.4, the forcing function is,

$$f(u,t) = g - \frac{1}{m_p} D(u) \tag{1.9} $$

From the definition of $D(u)$, $f(u,t)$ is nonlinear in $u$. Note also that in this example, $f$ does not depend on $t$ directly, rather $f(u(t),t) = f(u(t))$.

Linear ODEs
Although the use of numerical integration is most important for nonlinear ODE's (since analytic solutions rarely exist), the study of numerical methods applied to linear ODE's is often quite helpful in understanding the behavior for nonlinear problems. The general form for a single, linear ODE, is

$$ u_t = \lambda (t) u(t) + g(t), \tag{1.10} $$

where $\lambda (t)$ is independent of $u$. When $\lambda (t)$ is a constant, the ODE is referred to as a linear ODE with constant coefficients.

In many situations, the linear ODE is derived by linearizing a nonlinear ODE about a constant state. Specifically, define the dependent state $u(t)$ as a sum of $u_0$ and a perturbation, $\tilde{u}(t)$,

$$u(t) = u_0 + \tilde{u}(t). \tag{1.11}$$

A linearized equation for the evolution of $\tilde{u}(t)$ can be derived by substitution of this into **Equation 1.8**:

$$
\begin{align}
u_t  &= f(u(t),t) \tag{1.12} \\
\tilde{u}_t &= f(u_0 + \tilde{u}(t),t) \tag{1.13} \\
\tilde{u}_t &= f(u_0, 0) + \left.\frac{\partial f}{\partial u}\right|_{u_0,0}\tilde{u}(t) + \left.\frac{\partial f}{\partial t}\right|_{u_0,0}t + O(t^2, \tilde{u} t, \tilde{u}^2) \tag{1.14}
\end{align}
$$

Note that the last equation is obtained using Taylor series. Thus, when $t$ and $\tilde{u}$ are small, the perturbation satisfies the linear equation,

$$ \tilde{u}_ t \approx f(u_0, 0) + \left.\frac{\partial f}{\partial u}\right|_{u_0,0}\tilde{u}(t) + \left.\frac{\partial f}{\partial t}\right|_{u_0,0}t \tag{1.15} $$

Comparing Equation 1.10 to 1.15, we see that in this example,

$$\begin{align}
\lambda (t) &= \left.\frac{\partial f}{\partial u}\right|_{u_0,0} \tag{1.16} \\
g(t) &= f(u_0, 0) + \left.\frac{\partial f}{\partial t}\right|_{u_0,0}t \tag{1.17}
\end{align}$$

For the falling sphere problem, a linear ODE can be derived by linearizing about the initial velocity $u_0$. As shown above, this requires the calculation of ${\partial f}/{\partial u}$ and ${\partial f}/{\partial t}$. For the sphere,

$$ \frac{\partial f}{\partial u} = \frac{\partial }{\partial u}\left[ g - \frac{1}{m_ p} D(u(t))\right] = -\frac{1}{m_ p}\frac{\partial D}{\partial u} \tag{1.18} $$

The value of ${\partial D}/{\partial u}$ is

$$
\begin{align}
\frac{\partial D}{\partial u} &= \frac{\partial }{\partial u}\left[ \frac{1}{2}\rho _ g \pi a^2 u^2 C_ D(Re) \right] \tag{1.19} \\
&= \rho _ g \pi a^2 u C_ D(Re) + \frac{1}{2}\rho _ g \pi a^2 u^2 \frac{\partial C_ D}{\partial Re}\frac{\partial Re}{\partial u} \tag{1.20}
\end{align}
$$

and ${\partial C_ D}/{\partial Re}$ and ${\partial Re}/{\partial u}$ can be found from their definitions. Also, since $f$ does not directly depend on $t$ for this problem, ${\partial f}/{\partial t} = 0.$

